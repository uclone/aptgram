<!DOCTYPE html>
<html lang="ko">
{% extends 'base.html' %}
{% load bootstrap4 %}
{% load mathfilters %}

<head>
    <meta charset="UTF-8">
    <title>safety-search</title>

{% block extrahead %}
{{ form.media }}
{% endblock %}

</head>

<body>
{% block content %}
    <p></p>
    <form method="get">
        {% bootstrap_form filter.form %}
        <p></p>
        <div class="btn-toolbar float-right">
            <a href="{% url 'metergram:meter_chart' %}" class="btn btn-secondary btn-sm">차트출력</a>
            <a href="{% url 'metergram:search_xls' %}" class="btn btn-warning btn-sm">엑셀출력</a>
            <a href="{% url 'metergram:search_pdf' %}" class="btn btn-success btn-sm">pdf출력</a></div>
        <div class="btn-toolbar float-left">
            <a href="{% url 'metergram:meter_list' %}" class="btn btn-primary btn-sm">전체측정자료</a>
            <button type="submit" class="btn btn-info btn-sm">검색하기</button></div>
        <p></p>
    </form>
    <p></p>

    <table class="table">
        <thead>
            <tr>
                <th class="text-center" scope="col">동:호</th>
                <th class="text-center" scope="col">장치번호</th>
                <th class="text-center" scope="col">가스계량값</th>
                <th class="text-center" scope="col">가스보정값</th>
                <th class="text-center" scope="col">전력사용량</th>
                <th class="text-center" scope="col">수도사용량</th>
                <th class="text-center" scope="col">온도(*C)</th>
                <th class="text-center" scope="col">습도(%)</th>
                <th class="text-center" scope="col">가스사용</th>
                <th class="text-center" scope="col">수도사용</th>
                <th class="text-center" scope="col">경보</th>
                <th class="text-center" scope="col">해당일시</th>
            </tr>
        </thead>

        <tbody>
            {% for post in filter.qs %}
                <tr>
                    <td align="center">{{post.location}}</td>
                    <td><a href="{% url 'metergram:meter_detail' pk=post.id %}">{{post.serial}}</a></td>
                    <td align="center">{{post.mtr|div:100}}</td>
                    <td align="center">{{post.cor|div:100}}</td>
                    <td align="center">{{post.elec|div:100}}</td>
                    <td align="center">{{post.water|div:100}}</td>
                    <td align="center">{{post.temp|div:10}}</td>
                    {% if post.humidity > 8000 or post.ph < 200 %}
                    <td align="center" style="color:red">{{post.humidity|div:10}}</td>
                    {% else %}
                    <td align="center" style="color:blue">{{post.humidity}}</td>
                    {% endif %}
                    <td align="center">{{post.usegas}}</td>
                    <td align="center">{{post.usewater}}</td>
                    <td align="center">{{post.alarm}}</td>
                    <td align="center">{{post.date|date:"y-m-d H:i"}}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}

</body>
</html>